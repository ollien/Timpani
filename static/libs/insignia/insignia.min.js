!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.insignia=e()}}(function(){return function e(t,n,r){function i(a,l){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!l&&u)return u(a,!0);if(o)return o(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return i(n?n:e)},f,f.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){"use strict";var r=e("crossvent"),i=e("./dom"),o=e("./text"),a=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","webkitBoxSizing","mozBoxSizing","boxSizing","padding","border"],l=20;t.exports=function(e){function t(){var e,t,n=f();for(t=0;t<a.length;t++)e=n[a[t]],void 0!==e&&null!==e&&(c.style[a[t]]=e);c.disabled="disabled",c.style.whiteSpace="pre",c.style.position="absolute",c.style.top=c.style.left="-9999em"}function n(){var t=e.value;if(t!==c.value)if(o(c,t),"input"===e.tagName.toLowerCase()&&0===e.value.length){var n=window.getComputedStyle(e,":placeholder");e.style.width=n.length+"px"}else{var r=c.offsetWidth+l;e.style.width=r+"px"}}function u(t){var i=t?"remove":"add";r[i](e,"keydown",n),r[i](e,"keyup",n),r[i](e,"input",n),r[i](e,"paste",n),r[i](e,"change",n)}function s(){u(!0),c.parentElement.removeChild(c),e.style.width=""}function f(){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle}var c=i("span");return document.body.appendChild(c),t(),u(),{remap:t,refresh:n,destroy:s}}},{"./dom":2,"./text":11,crossvent:5}],2:[function(e,t,n){"use strict";t.exports=function(e,t){var n=document.createElement(e);return t&&(n.className=t),n}},{}],3:[function(e,t,n){"use strict";function r(e){var t,n;for(n=0;n<C.length;n++)if(t=C[n],t.el===e)return t.api;return null}function i(e,t){function n(t){var n=t?"remove":"add";o[n](e,"keydown",z),o[n](e,"keypress",D),o[n](e,"paste",j),o[n](ie,"click",k),te&&o[n](document.documentElement,"focus",N,!0)}function i(){return n(!0),e.value=$(),e.className=e.className.replace(x,""),ie.className=ie.className.replace(w,""),ne.parentElement.removeChild(ne),re.parentElement.removeChild(re),C.splice(C.indexOf(le),1),oe.destroy(),ae.destroyed=!0,ae.destroy=O(ae),ae.tags=ae.value=O(null),ae}function O(e){return function(){return e}}function N(t){t.target!==e&&(H=!0,B(!0),H=!1)}function k(t){var n=t.target;if(b.test(n.className))return R(n.parentElement,{start:"end",end:"end",remove:!0}),void T();for(var r=n,i=y.test(r.className);i===!1&&r.parentElement;)r=r.parentElement,i=y.test(r.className);i?R(r,E):n!==e&&(T(),e.focus())}function T(){R(re.lastChild,E),A([K],!0)}function B(t){return A([K],t),t&&U(re,F),o.fabricate(e,"insignia-converted"),ae}function F(e,t){ne.appendChild(t)}function z(t){var n=f(e),r=t.which||t.keyCode||t.charCode;if(r===m)ne.firstChild?R(ne.firstChild,{}):f(e,{start:0,end:0});else if(r===v)re.lastChild?R(re.lastChild,E):f(e,E);else if(r===h&&0===n.start&&ne.lastChild)R(ne.lastChild,E);else if(r!==p||0!==n.start||0!==n.end&&n.end===e.value.length||!ne.lastChild){if(r!==g||n.end!==e.value.length||!re.firstChild)return;R(re.firstChild,{})}else R(ne.lastChild,E);return t.preventDefault(),!1}function D(e){var t=e.which||e.keyCode||e.charCode;return String.fromCharCode(t)===K?(B(),e.preventDefault(),!1):void 0}function j(){setTimeout(function(){A()},0)}function A(t,n){var r=f(e),i=n?1/0:r.start,a=e.value.slice(0,i).concat(t||[]).split(K);if(!(a.length<1)){var l,u=a.pop()+e.value.slice(i),s=a.join(K).length;for(l=0;l<a.length;l++)M(ne,a[l]);L(),e.value=u,r.start-=s,r.end-=s,H!==!0&&f(e,r),oe.refresh(),o.fabricate(e,"insignia-evaluated")}}function L(){function e(e,n){Y(e,u(t))?t.push(e):n.parentElement.removeChild(n)}var t=[];U(ne,e),U(re,e)}function q(e,t){l(e,t)}function I(e){return l(e)}function M(e,t){var n=t.trim();if(0!==n.length){var r=a("span","nsg-tag");Z(r,X(n)),J.deletion&&r.appendChild(a("span","nsg-tag-remove")),e.appendChild(r)}}function R(t,n){if(t){A([K],!0);var r=t.parentElement;if(r===ne)for(;r.lastChild!==t;)re.insertBefore(r.lastChild,re.firstChild);else for(;r.firstChild!==t;)ne.appendChild(r.firstChild);t.parentElement.removeChild(t),e.value=n.remove?"":ee(t),e.focus(),f(e,n),oe.refresh()}}function P(){var t,n=e.parentElement.children;for(t=0;t<n.length;t++)if(n[t]!==e&&n[t].nodeType===d)return!0;return!1}function U(e,t){var n,r,i=u(e.children);for(n=0;n<i.length;n++)r=i[n],t(ee(r),r,n)}function W(){function t(e){if(e){var t=X(e);Y(t,u(r))&&r.push(t)}}var n,r=[],i=e.value.split(K);for(U(ne,t),n=0;n<i.length;n++)t(i[n]);return U(re,t),r}function $(){return W().join(K)}function _(e){return e.trim().toLowerCase()}function V(e,t){return-1===t.indexOf(e)}var G=r(e);if(G)return G;var H=document.activeElement!==e,J=t||{},K=J.delimiter||S;if(1!==K.length)throw new Error("Insignia expected a single-character delimiter string");var Q=P(e);if(Q||!c.test(e.tagName))throw new Error("Insignia expected an input element without any siblings");var X=J.parse||_,Y=J.validate||V,Z=J.render||q,ee=J.readTag||I,te=J.convertOnFocus!==!1,ne=a("span","nsg-tags nsg-tags-before"),re=a("span","nsg-tags nsg-tags-after"),ie=e.parentElement;e.className+=" nsg-input",ie.className+=" nsg-editor",ie.insertBefore(ne,e),ie.insertBefore(re,e.nextSibling),n();var oe=s(e),ae={tags:W,value:$,convert:B,destroy:i},le={el:e,api:ae};return A([K],!0),C.push(le),H=!1,ae}e("./polyfills/String.prototype.trim"),e("./polyfills/Array.prototype.indexOf");var o=e("crossvent"),a=e("./dom"),l=e("./text"),u=e("./slice"),s=e("./autosize"),f=e("./selection"),c=/^input$/i,d=1,p=8,v=35,m=36,h=37,g=39,y=/\bnsg-tag\b/,b=/\bnsg-tag-remove\b/,w=/\bnsg-editor\b/g,x=/\bnsg-input\b/g,E={start:"end",end:"end"},C=[],S=" ";i.find=r,t.exports=i},{"./autosize":1,"./dom":2,"./polyfills/Array.prototype.indexOf":7,"./polyfills/String.prototype.trim":8,"./selection":9,"./slice":10,"./text":11,crossvent:5}],4:[function(e,t,n){(function(e){function n(){try{var e=new r("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(t){}return!1}var r=e.CustomEvent;t.exports=n()?r:"function"==typeof document.createEvent?function(e,t){var n=document.createEvent("CustomEvent");return t?n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):n.initCustomEvent(e,!1,!1,void 0),n}:function(e,t){var n=document.createEventObject();return n.type=e,t?(n.bubbles=Boolean(t.bubbles),n.cancelable=Boolean(t.cancelable),n.detail=t.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){(function(n){"use strict";function r(e,t,n,r){return e.addEventListener(t,n,r)}function i(e,t,n){return e.attachEvent("on"+t,s(e,t,n))}function o(e,t,n,r){return e.removeEventListener(t,n,r)}function a(e,t,n){var r=f(e,t,n);return r?e.detachEvent("on"+t,r):void 0}function l(e,t,n){function r(){var e;return v.createEvent?(e=v.createEvent("Event"),e.initEvent(t,!0,!0)):v.createEventObject&&(e=v.createEventObject()),e}function i(){return new d(t,{detail:n})}var o=-1===p.indexOf(t)?i():r();e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on"+t,o)}function u(e,t,r){return function(t){var i=t||n.event;i.target=i.target||i.srcElement,i.preventDefault=i.preventDefault||function(){i.returnValue=!1},i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=!0},i.which=i.which||i.keyCode,r.call(e,i)}}function s(e,t,n){var r=f(e,t,n)||u(e,t,n);return g.push({wrapper:r,element:e,type:t,fn:n}),r}function f(e,t,n){var r=c(e,t,n);if(r){var i=g[r].wrapper;return g.splice(r,1),i}}function c(e,t,n){var r,i;for(r=0;r<g.length;r++)if(i=g[r],i.element===e&&i.type===t&&i.fn===n)return r}var d=e("custom-event"),p=e("./eventmap"),v=n.document,m=r,h=o,g=[];n.addEventListener||(m=i,h=a),t.exports={add:m,remove:h,fabricate:l}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":6,"custom-event":4}],6:[function(e,t,n){(function(e){"use strict";var n=[],r="",i=/^on/;for(r in e)i.test(r)&&n.push(r.slice(2));t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(void 0===this||null===this)throw new TypeError;var n=this.length;for(t=+t||0,Math.abs(t)===1/0?t=0:0>t&&(t+=n,0>t&&(t=0));n>t;t++)if(this[t]===e)return t;return-1})},{}],8:[function(e,t,n){"use strict";if(!String.prototype.trim){var r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(r,"")}}},{}],9:[function(e,t,n){"use strict";function r(e){return{start:e.selectionStart,end:e.selectionEnd}}function i(e){function t(t,r){return n!==e&&(n?n.focus():e.blur()),{start:t,end:r}}var n=document.activeElement;n!==e&&e.focus();var r=document.selection.createRange(),i=r.getBookmark(),l=e.value,u=o(l),s=r.parentElement();if(null===s||!a(s))return t(0,0);r.text=u+r.text+u;var f=e.value;return e.value=l,r.moveToBookmark(i),r.select(),t(f.indexOf(u),f.lastIndexOf(u)-u.length)}function o(e){var t;do t="@@marker."+Math.random()*new Date;while(-1!==e.indexOf(t));return t}function a(e){return p.test(e.tagName)&&"text"===e.type||v.test(e.tagName)}function l(e,t){e.selectionStart=s(e,t.start),e.selectionEnd=s(e,t.end)}function u(e,t){var n=e.createTextRange();"end"===t.start&&"end"===t.end?(n.collapse(!1),n.select()):(n.collapse(!0),n.moveEnd("character",t.end),n.moveStart("character",t.start),n.select())}function s(e,t){return"end"===t?e.value.length:t||0}function f(e,t){return 2===arguments.length&&d(e,t),c(e)}var c=r,d=l,p=/input/i,v=/textarea/i;document.selection&&document.selection.createRange&&(c=i,d=u),t.exports=f},{}],10:[function(e,t,n){"use strict";function r(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e[t]);return n}t.exports=r},{}],11:[function(e,t,n){"use strict";function r(e,t){return 2===arguments.length&&(e.innerText=e.textContent=t),"string"==typeof e.innerText?e.innerText:e.textContent}t.exports=r},{}]},{},[3])(3)});