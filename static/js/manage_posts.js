document.addEventListener("DOMContentLoaded",function(e){function t(e,t){e.abort(),t.classList.remove("working"),t.disabled=!1}var o=document.querySelector(".modal"),n=new Modal(o);n.positiveButton=n.element.querySelector("button.positive");var i=document.querySelectorAll("a.button.delete"),r=document.querySelector("span.delete-post-title");n.element.addEventListener("positive-pressed",function(e){e.preventDefault();var o=n.element.getAttribute("post-id"),i=new XMLHttpRequest;i.open("POST","/delete_post/"+o),i.addEventListener("load",function(e){var t=JSON.parse(i.responseText);if(0===t.error){n.positiveButton.classList.remove("working"),n.positiveButton.disabled=!1,n.hide();var r=document.querySelector('li[post-id="'+o+'"]');r.addEventListener("transitionend",function(e){this.remove()}),r.classList.add("deleting")}else 1===t.error&&(window.location="/login")}),n.positiveButton.disabled=!0,n.positiveButton.classList.add("working"),this.addEventListener("neutral-pressed",function(e){t(i,n.positiveButton)}),i.send()}),Array.prototype.slice.call(i).forEach(function(e){e.addEventListener("click",function(t){var i=e.parentNode.parentNode,s=i.querySelector("a.post-title").textContent;o.setAttribute("post-id",i.getAttribute("post-id")),r.textContent=s,n.show()})})});